<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title><!-- Insert your title here --></title>
    <style>
    </style>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js" type="text/javascript"> </script>
    <script type="text/javascript">
    
    
    $(document).ready(function() {
    var Tweet = function () {
        this.img = null;
        this.user = null;
        this.text = null;
    }
    var divToTweetIn=           "#test1";
    <!-- ms between calls to refresh the feed -->
    var tweetRefreshInterval=   5000;
    var tweetsPerPage=          50;
    var tweetPageNumber=        1;
    var tweetShowUser=          "true";
    <!-- the tweet string to search for on twitter -->
    var tweetQuery=             "@humphd";
    var tweets = [];
    var newTweets = [];
    <!-- Contains the id of the most recent tweet that twitter grabbed for us. This is put into the since_id-->
    <!-- parameter to cause future update requests to only return new tweets for us -->
    var lastUpdatePoint = 0;
    var getTweets = function(query){
        
        <!-- the actual json url -->
        var url="http://search.twitter.com/search.json?rpp="+tweetsPerPage+"&since_id="+lastUpdatePoint+"&show_user="+tweetShowUser+"&page="+tweetPageNumber+"&q=";
        $.getJSON(url+query,function(json){
            <!-- by putting the max update id of the current set of tweets into the since_id parameter we avoid-->
            <!-- getting any duplicate tweets on future refreshes -->
            lastUpdatePoint = json.max_id_str;
            newTweets = [];
            $.each(json.results, function(i, t){
                newTweets[i] = new Tweet();     
                newTweets[i].img = t.profile_image_url;
                newTweets[i].text = t.text;
                newTweets[i].user = t.from_user;
                tweets.push(newTweets[i]);
            });
            <!-- Get rid of tweets that won't be shown -->
            for (var currentIndex = tweetsPerPage; currentIndex < tweets.length; currentIndex++)
            {
                tweets.pop();
            }
            $(divToTweetIn).innerHTML = "";
            $(divToTweetIn).append("<h2>Showing tweets related to " + tweetQuery + "</h2></br>");
            
            $.each(tweets, function(tweetIndex,currentTweet){
                if (tweetIndex < tweetsPerPage)
                {
                    var userImage = "<img src='" + currentTweet.img +"'/>";
                    var userLink = "<a href='http://twitter.com/"+ currentTweet.user + "'>" + userImage + "</a>";
                    $(divToTweetIn).append(userLink + currentTweet.text + "<br/>");
                }
            });
        });
    };

        setInterval(getTweets(tweetQuery), tweetRefreshInterval);
      
    });
    </script>
    <!-- -->
</head>
<body>
    <div id="test1">
    </div>
</body>
</html>